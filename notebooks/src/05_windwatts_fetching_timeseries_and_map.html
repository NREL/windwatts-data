<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>windwatts_data fetching timeseries and map data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="05_windwatts_fetching_timeseries_and_map_files/libs/clipboard/clipboard.min.js"></script>
<script src="05_windwatts_fetching_timeseries_and_map_files/libs/quarto-html/quarto.js"></script>
<script src="05_windwatts_fetching_timeseries_and_map_files/libs/quarto-html/popper.min.js"></script>
<script src="05_windwatts_fetching_timeseries_and_map_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="05_windwatts_fetching_timeseries_and_map_files/libs/quarto-html/anchor.min.js"></script>
<link href="05_windwatts_fetching_timeseries_and_map_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="05_windwatts_fetching_timeseries_and_map_files/libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="05_windwatts_fetching_timeseries_and_map_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="05_windwatts_fetching_timeseries_and_map_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="05_windwatts_fetching_timeseries_and_map_files/libs/bootstrap/bootstrap-973236bd072d72a04ee9cd82dcc9cb29.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">windwatts_data fetching timeseries and map data</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>This notebook guides the user regarding how to fetch timeseries data for a specific/all location at runtime.</p>
<p>Note: The users AWS credentials should be exported in the created environment.</p>
<div id="bc4bcb16" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import package</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> windwatts_data <span class="im">import</span> WTKLedClient1224</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We have imported WTKLedClient1224 class to work with WTK hourly average data.</p>
<div id="cda515ad" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize object to the WTKLedClient</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Since the config file is in same directory "notebooks" as the ".ipynb" file, the below config path works.</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>wtk <span class="op">=</span> WTKLedClient1224(config_path<span class="op">=</span><span class="st">'./1224_config.json'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Fetching results...: 0polls [00:00, ?polls/s]Fetching results...: 1polls [00:00,  1.79polls/s]Fetching results...: 2polls [00:01,  1.17polls/s]Fetching results...: 3polls [00:03,  1.41s/polls]Fetching results...: 3polls [00:03,  1.25s/polls]</code></pre>
</div>
</div>
<section id="robust-function-for-fetching-both-timeseries-and-map." class="level2">
<h2 class="anchored" data-anchor-id="robust-function-for-fetching-both-timeseries-and-map.">Robust function for fetching both timeseries and map.</h2>
<p><strong>fetch_filtered_data_1224()</strong> is more robust version to fetch both timeseries(location specific) and map(non-locations specific) data which provides user with more parameters to retrieve data. Please refer to the documentation to know more about the functionâ€™s features. The <strong>fetch_timeseries_1224()</strong>, <strong>fetch_windspeed_map_1224()</strong> and <strong>fetch_winddirection_map_1224()</strong> were the safe function as they restricted user in terms of paramaters as it was done intentionally to safe gaurd user from performing costly queries if same can be achieved using earlier functions.</p>
<p><strong>fetch_filtered_data_1224()</strong>* gives the user full freedom to perform complex queries.</p>
<div id="8139cd46" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fetching desired columns for specified location and year.</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> wtk.fetch_filtered_data_1224(columns<span class="op">=</span>[<span class="st">'windspeed_100m'</span>,<span class="st">'winddirection_100m'</span>,<span class="st">'mohr'</span>],lat<span class="op">=</span><span class="fl">39.90270</span>,<span class="bu">long</span><span class="op">=-</span><span class="fl">82.98916</span>,years<span class="op">=</span>[<span class="dv">2001</span>],n_nearest<span class="op">=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Fetching results...: 0polls [00:00, ?polls/s]Fetching results...: 1polls [00:00,  1.76polls/s]Fetching results...: 1polls [00:00,  1.55polls/s]</code></pre>
</div>
</div>
<div id="6f93a18f" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">windspeed_100m</th>
<th data-quarto-table-cell-role="th">winddirection_100m</th>
<th data-quarto-table-cell-role="th">mohr</th>
<th data-quarto-table-cell-role="th">index</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>8.57</td>
<td>235.60</td>
<td>101</td>
<td>1b2e7e</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>9.64</td>
<td>248.90</td>
<td>102</td>
<td>1b2e7e</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>9.35</td>
<td>244.47</td>
<td>103</td>
<td>1b2e7e</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>9.51</td>
<td>245.31</td>
<td>104</td>
<td>1b2e7e</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>8.91</td>
<td>241.61</td>
<td>105</td>
<td>1b2e7e</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">571</td>
<td>5.38</td>
<td>233.07</td>
<td>1220</td>
<td>1b2e7f</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">572</td>
<td>5.86</td>
<td>230.06</td>
<td>1221</td>
<td>1b2e7f</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">573</td>
<td>6.05</td>
<td>230.55</td>
<td>1222</td>
<td>1b2e7f</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">574</td>
<td>6.65</td>
<td>231.77</td>
<td>1223</td>
<td>1b2e7f</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">575</td>
<td>7.09</td>
<td>234.65</td>
<td>1224</td>
<td>1b2e7f</td>
</tr>
</tbody>
</table>

<p>576 rows Ã— 4 columns</p>
</div>
</div>
</div>
<p>This function can do the same thing as fetch_windspeed_timeseries_1224(). But it offers more control over selection of more columns, selection by time and doesnâ€™t restrict user to a number of nearest location(1-16) as it was in case of the safe function. n_nearest is optional here when given along with latitude and longitude. No need to specify n_nearest when you are not specifying latitude and longitude as all locations will be considered.</p>
</section>
<section id="fetching-timeseries-data" class="level2">
<h2 class="anchored" data-anchor-id="fetching-timeseries-data">Fetching timeseries data</h2>
<div id="adf4a3d3" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fetching desired columns for specified location, year, month and hour.</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> wtk.fetch_filtered_data_1224(columns<span class="op">=</span>[<span class="st">'windspeed_100m'</span>,<span class="st">'winddirection_100m'</span>,<span class="st">'mohr'</span>],lat<span class="op">=</span><span class="fl">39.90270</span>,<span class="bu">long</span><span class="op">=-</span><span class="fl">82.98916</span>,years<span class="op">=</span>[<span class="dv">2001</span>],months<span class="op">=</span>[<span class="dv">2</span>],hours<span class="op">=</span>[<span class="dv">12</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Fetching results...: 0polls [00:00, ?polls/s]Fetching results...: 1polls [00:00,  1.77polls/s]Fetching results...: 1polls [00:00,  1.60polls/s]</code></pre>
</div>
</div>
<div id="0c638c95" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">windspeed_100m</th>
<th data-quarto-table-cell-role="th">winddirection_100m</th>
<th data-quarto-table-cell-role="th">mohr</th>
<th data-quarto-table-cell-role="th">index</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>7.63</td>
<td>279.12</td>
<td>212</td>
<td>1b2e7e</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="16eea6dd" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># user can also specify multiple years, months and hours.</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> wtk.fetch_filtered_data_1224(columns<span class="op">=</span>[<span class="st">'windspeed_100m'</span>,<span class="st">'winddirection_100m'</span>,<span class="st">'mohr'</span>],lat<span class="op">=</span><span class="fl">39.90270</span>,<span class="bu">long</span><span class="op">=-</span><span class="fl">82.98916</span>,years<span class="op">=</span>[<span class="dv">2001</span>],months<span class="op">=</span>[<span class="dv">2</span>,<span class="dv">3</span>],hours<span class="op">=</span>[<span class="dv">12</span>,<span class="dv">1</span>],n_nearest<span class="op">=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Fetching results...: 0polls [00:00, ?polls/s]Fetching results...: 1polls [00:00,  1.78polls/s]Fetching results...: 1polls [00:00,  1.60polls/s]</code></pre>
</div>
</div>
<div id="5225720d" class="cell" data-execution_count="8">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">windspeed_100m</th>
<th data-quarto-table-cell-role="th">winddirection_100m</th>
<th data-quarto-table-cell-role="th">mohr</th>
<th data-quarto-table-cell-role="th">index</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>9.67</td>
<td>229.34</td>
<td>201</td>
<td>1b2e7e</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>7.63</td>
<td>279.12</td>
<td>212</td>
<td>1b2e7e</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>8.15</td>
<td>317.10</td>
<td>301</td>
<td>1b2e7e</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>7.59</td>
<td>332.10</td>
<td>312</td>
<td>1b2e7e</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>9.68</td>
<td>229.98</td>
<td>201</td>
<td>1b2e7f</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>7.54</td>
<td>280.77</td>
<td>212</td>
<td>1b2e7f</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>8.28</td>
<td>316.05</td>
<td>301</td>
<td>1b2e7f</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>7.62</td>
<td>331.03</td>
<td>312</td>
<td>1b2e7f</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="756f56fd" class="cell" data-execution_count="9">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Instead of column names, users can also specify desired height(s) to extract columns specific to a height(s).</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> wtk.fetch_filtered_data_1224(heights<span class="op">=</span>[<span class="dv">100</span>],lat<span class="op">=</span><span class="fl">39.90270</span>,<span class="bu">long</span><span class="op">=-</span><span class="fl">82.98916</span>,years<span class="op">=</span>[<span class="dv">2001</span>,<span class="dv">2002</span>],months<span class="op">=</span>[<span class="dv">2</span>],hours<span class="op">=</span>[<span class="dv">12</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Fetching results...: 0polls [00:00, ?polls/s]Fetching results...: 1polls [00:00,  1.81polls/s]Fetching results...: 1polls [00:00,  1.63polls/s]</code></pre>
</div>
</div>
<div id="4112fd4c" class="cell" data-execution_count="10">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">pressure_100m</th>
<th data-quarto-table-cell-role="th">temperature_100m</th>
<th data-quarto-table-cell-role="th">winddirection_100m</th>
<th data-quarto-table-cell-role="th">windspeed_100m</th>
<th data-quarto-table-cell-role="th">mohr</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">index</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>98570.0</td>
<td>-0.18</td>
<td>279.12</td>
<td>7.63</td>
<td>212</td>
<td>2001</td>
<td>1b2e7e</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>98220.0</td>
<td>-0.66</td>
<td>281.91</td>
<td>7.79</td>
<td>212</td>
<td>2002</td>
<td>1b2e7e</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="94d2a8e6" class="cell" data-execution_count="11">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># If a specific height doesn't exist in the columns, then the columns adjacent to the given height values will be returned. Columns with height 20m doesn't exist in the data.</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> wtk.fetch_filtered_data_1224(heights<span class="op">=</span>[<span class="dv">20</span>],lat<span class="op">=</span><span class="fl">39.90270</span>,<span class="bu">long</span><span class="op">=-</span><span class="fl">82.98916</span>,years<span class="op">=</span>[<span class="dv">2001</span>,<span class="dv">2002</span>],months<span class="op">=</span>[<span class="dv">2</span>],hours<span class="op">=</span>[<span class="dv">12</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Fetching results...: 0polls [00:00, ?polls/s]Fetching results...: 1polls [00:00,  1.78polls/s]Fetching results...: 1polls [00:00,  1.61polls/s]</code></pre>
</div>
</div>
<div id="44081d96" class="cell" data-execution_count="12">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">temperature_30m</th>
<th data-quarto-table-cell-role="th">winddirection_10m</th>
<th data-quarto-table-cell-role="th">winddirection_30m</th>
<th data-quarto-table-cell-role="th">windspeed_10m</th>
<th data-quarto-table-cell-role="th">windspeed_30m</th>
<th data-quarto-table-cell-role="th">mohr</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">index</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.64</td>
<td>257.96</td>
<td>266.75</td>
<td>2.59</td>
<td>4.51</td>
<td>212</td>
<td>2002</td>
<td>1b2e7e</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-0.26</td>
<td>243.36</td>
<td>262.87</td>
<td>2.29</td>
<td>4.12</td>
<td>212</td>
<td>2001</td>
<td>1b2e7e</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Note: You can either mention specific column names or specific heights, not both.</p>
</section>
<section id="fetching-map-data" class="level2">
<h2 class="anchored" data-anchor-id="fetching-map-data">Fetching map data</h2>
<div id="d64760c7" class="cell" data-execution_count="13">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fetching windspeed map data at 100m for a specific time.</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> wtk.fetch_filtered_data_1224(columns<span class="op">=</span>[<span class="st">'windspeed_100m'</span>],years<span class="op">=</span>[<span class="dv">2001</span>],months<span class="op">=</span>[<span class="dv">2</span>],hours<span class="op">=</span>[<span class="dv">12</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Fetching results...: 0polls [00:00, ?polls/s]Fetching results...: 1polls [00:00,  1.79polls/s]Fetching results...: 1polls [00:00,  1.62polls/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Query result is stored at: s3://wtk-test-athena-results/e69cefa2-f9f4-421c-aac3-720cc0f3ef61.csv.</code></pre>
</div>
</div>
<div id="56c459ee" class="cell" data-execution_count="14">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">windspeed_100m</th>
<th data-quarto-table-cell-role="th">index</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>12.88</td>
<td>0002e7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>14.35</td>
<td>00034a</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>12.91</td>
<td>00008c</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>12.48</td>
<td>00026d</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>7.76</td>
<td>0003c0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2599772</td>
<td>9.90</td>
<td>278d34</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2599773</td>
<td>9.62</td>
<td>278e42</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2599774</td>
<td>9.76</td>
<td>278f16</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2599775</td>
<td>9.77</td>
<td>278f27</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2599776</td>
<td>9.82</td>
<td>278e73</td>
</tr>
</tbody>
</table>

<p>2599777 rows Ã— 2 columns</p>
</div>
</div>
</div>
<div id="4e9814fe" class="cell" data-execution_count="15">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fetching windspeed map data at 100m for multiple time periods.</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> wtk.fetch_filtered_data_1224(columns<span class="op">=</span>[<span class="st">'windspeed_100m'</span>,<span class="st">'winddirection_100m'</span>,<span class="st">'mohr'</span>,<span class="st">'year'</span>],years<span class="op">=</span>[<span class="dv">2001</span>,<span class="dv">2002</span>],months<span class="op">=</span>[<span class="dv">2</span>,<span class="dv">4</span>],hours<span class="op">=</span>[<span class="dv">12</span>,<span class="dv">15</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Fetching results...: 0polls [00:00, ?polls/s]Fetching results...: 1polls [00:00,  1.80polls/s]Fetching results...: 1polls [00:00,  1.62polls/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Query result is stored at: s3://wtk-test-athena-results/8949f85a-674a-429d-b84a-1d99ac3d47ef.csv.</code></pre>
</div>
</div>
<div id="d9f157fd" class="cell" data-execution_count="16">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="16">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">windspeed_100m</th>
<th data-quarto-table-cell-role="th">winddirection_100m</th>
<th data-quarto-table-cell-role="th">mohr</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">index</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>10.83</td>
<td>24.32</td>
<td>212</td>
<td>2002</td>
<td>00018b</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>10.74</td>
<td>20.28</td>
<td>215</td>
<td>2002</td>
<td>00018b</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>9.74</td>
<td>67.91</td>
<td>412</td>
<td>2002</td>
<td>00018b</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>9.69</td>
<td>294.94</td>
<td>415</td>
<td>2002</td>
<td>00018b</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>11.47</td>
<td>255.09</td>
<td>212</td>
<td>2002</td>
<td>000049</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20798211</td>
<td>10.18</td>
<td>87.54</td>
<td>415</td>
<td>2001</td>
<td>2758ba</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20798212</td>
<td>9.68</td>
<td>68.46</td>
<td>212</td>
<td>2001</td>
<td>2757f2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20798213</td>
<td>9.81</td>
<td>69.32</td>
<td>215</td>
<td>2001</td>
<td>2757f2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20798214</td>
<td>7.67</td>
<td>88.65</td>
<td>412</td>
<td>2001</td>
<td>2757f2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20798215</td>
<td>7.61</td>
<td>89.20</td>
<td>415</td>
<td>2001</td>
<td>2757f2</td>
</tr>
</tbody>
</table>

<p>20798216 rows Ã— 5 columns</p>
</div>
</div>
</div>
<div id="f88a23da" class="cell" data-execution_count="17">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'month'</span>],df[<span class="st">'hour'</span>] <span class="op">=</span> df[<span class="st">'mohr'</span>]<span class="op">//</span><span class="dv">100</span>, df[<span class="st">'mohr'</span>]<span class="op">%</span><span class="dv">100</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df[<span class="st">'year'</span>].value_counts())</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df[<span class="st">'month'</span>].value_counts())</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df[<span class="st">'hour'</span>].value_counts())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>year
2002    10399108
2001    10399108
Name: count, dtype: int64
month
2    10399108
4    10399108
Name: count, dtype: int64
hour
12    10399108
15    10399108
Name: count, dtype: int64</code></pre>
</div>
</div>
<p>Note: User can observe that this function is more robust in fetching data compared to safe functions. It is advised to keep the query cost in the mind. The above query scanned around <strong>23 Gb</strong> of data in <strong>9 minutes</strong> to retrieve results. Athena charges $5 per TB scanned.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>